{% extends 'base.html' %}

{% block title %} Bills {% endblock %}



{% block content %}

    <h2 class="text-center mt-5">Bills </h2>

    <p class="text-center">A place to view and follow bills. </p>

    <div class='container'>
        
        {% include 'bills/wtforms_subject_select.html' %}

        {% if bills%}

            <div class="row justify-content-end">
                <div class="col-1">
                    <div class="form-check form-switch mt-3">
                        <h5><input class="form-check-input" type="checkbox" id="show-details">
                        <label class="form-check-label" for="show-details">Details</label></h5>
                    </div>
                </div>
            </div>
            {%for bill in bills.items%}
                <div class="row justify-content-center">
                    <div class="col">
                        <div class="card mb-3" id='{{bill.id}}'>
                            <div class="card-header">
                                <div class="row justify-content-between">
                                    <div class="col-2 align-items-end text-right">
                                        <i class="fas fa-scroll"></i> {{bill.bill}}
                                    </div>
                                    <div class="col-1">
                                        <i class="btn btn-dark fas fa-bookmark follow-button"></i>
                                    </div>
                                </div>
                            </div>
                            <div class="card-body mt-1">
                                <div class="row last-major-action d-none mb-3">
                                    <div class="col-12">
                                        <p class="card py-1 px-2 text-light bg-dark rounded d-inline-block mb-3"> <span class="font-weight-bold"><i class="far fa-dot-circle"></i> Last Major Action: </span> <span class="font-italic">{{bill.latest_major_action}}</span></p>
                                    </div>
                                </div>
                                <div class="row justify-content-end">
                                    <div class="col-8">
                                        {% if bill.short_title %}
                                        <h5 class="card-title font-weight-bold">{{bill.short_title}}</h5>
                                        {% else %}
                                        <h5 class="card-title font-weight-bold">{{bill.title}}</h5>
                                        {% endif %}
                                    </div>
                                    <div class="col-4">
                                        <div class="row">
                                            <div class="col text-right">
                                                <i class="far fa-calendar-check"></i> <span class="font-weight-bold"></i>Introduced: </span>
                                            </div>
                                            <div class="col">
                                                {{bill.introduced_date}}
                                            </div>
                                            <div class="row">
                                                <div class="col">
                                                    <span class="font-weight-bold"><i class="fas fa-user-edit"></i> Primary Sponsor:</span>
                                                </div>
                                                <div class="col">
                                                    <a href="legislator/{{bill.sponsor[0].members.id}}"> <img class="rounded" style="width: 40px;" src="{{bill.sponsor[0].members.image}}" alt="No Image Available" onerror='this.src="{{g.member_default_image_path}}"'></a>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="summary-container d-none mt-3">
                                    {% if bill.summary %}
                                    <h5>Summary</h5>
                                    <p>{{prune_summary(bill.summary)}}</p>
                                    {% endif %}
                                </div>
                                <div class="buttons mt-3">
                                    <button class="summary-button btn btn-dark"><i class="fas fa-info-circle"></i> Details</button>
                                    <a href="/bills/{{bill.id}}" class="btn btn-outline-dark"><i class="fas fa-external-link-alt"></i> View Bill Page</a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            {% endfor %}

    <div class="container">
        <!-- Pagination Links-->
        <div id='pagination-links' class="text-right">
            <a href="{{ url_for('view_bills',policy_area=form.policy_area.data, session=form.session.data,page=bills.prev_num) }}"
            class="btn btn-outline-dark 
            {% if bills.page == 1 %}disabled{% endif %}">
                &laquo;
            </a>
        <!-- Loop through the number of pages to display a link for each-->
            {% for page_num in bills.iter_pages(left_edge=1, right_edge=1, left_current=1, right_current=2) %}
        {% if page_num %}
        <!-- Check for the active page and set the link to "Active"-->
                    {% if bills.page == page_num %}
                    <a href="{{ url_for('view_bills',policy_area=form.policy_area.data, session=form.session.data, page=page_num) }}"
                    class="btn btn-dark">
                        {{ page_num }}
                    </a>
                    {% else %}
                    <a href="{{ url_for('view_bills',policy_area=form.policy_area.data, session=form.session.data, page=page_num) }}"
                    class="btn btn-outline-dark">
                        {{ page_num }}
                    </a>
                    {% endif %}
                {% else %}
                    ...
                {% endif %}
            {% endfor %}
            <a href="{{ url_for('view_bills',policy_area=form.policy_area.data, session=form.session.data, page=bills.next_num) }}"
            class="btn btn-outline-dark 
            {% if bills.page == bills.pages %}disabled{% endif %}">
                &raquo;
            </a>
        </div>
        <p class="text-right mt-3">
        Showing page {{ bills.page }} of {{ bills.pages }}
        </p>
    </div>
        {% endif %}

        <h3>To Do:</h3>
        <p class="small text-danger font-italic">Now just Senate Bills - ADD House Bills</p>
        <p class="small text-danger font-italic">Add Pagination</p>
        <p class="small text-danger font-italic">Fix Individual Summary Show</p>
        <p class="small text-danger font-italic">Add All Summary Show/Hide Slider</p>
        <p class="small text-danger font-italic">Add more filters for browsing bills</p>
        

    </div>

{% endblock %}

